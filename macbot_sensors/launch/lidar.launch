<launch>
	<arg name = "show_ls"		default = "false"					/>
	<arg name = "type_ls"		default = "gpu_ray"					/>

	<!-- X2L ydlidar -->
	<node name = "ydlidar_node"  pkg = "ydlidar_ros"  type = "ydlidar_node" output = "screen" respawn = "false" >
		<param name = "port"				type = "string"		value = "/dev/ydlidar"/>  
		<param name = "baudrate"			type = "int"		value = "115200"/>  
		<param name = "frame_id"			type = "string"		value = "laser"/>
		<param name = "resolution_fixed"	type = "bool"		value = "true"/>
		<param name = "auto_reconnect"		type = "bool"		value = "true"/>
		<param name = "reversion"			type = "bool"		value = "false"/>
		<param name = "angle_min"			type = "double"		value = "-180" />
		<param name = "angle_max"			type = "double"		value = "180" />
		<param name = "range_min"			type = "double"		value = "0.1" />
		<param name = "range_max"			type = "double"		value =	"12.0" />
		<param name = "ignore_array"		type = "string"		value = "" />
		<param name = "frequency"			type = "double"		value = "8"/>
		<param name = "samp_rate"			type = "int"		value = "3"/>
		<param name = "isSingleChannel"		type = "bool"		value = "true"/>
	</node>

	<!-- <node pkg="tf" type="static_transform_publisher" name="base_link_to_laser4" args="0.2245 0.0 0.2 0.0 0.0  0.0 /base_link /laser_frame 40" /> -->
	<!--node name="rviz" pkg="rviz" type="rviz" args="-d $(find ydlidar_ros)/launch/lidar.rviz" /-->
	<param name = "robot_description" command = "$(find xacro)/xacro --inorder '$(find macbot_description)/urdf/robot_textured.xacro'"/>

	<node name = "robot_state_publisher" pkg = "robot_state_publisher" type = "robot_state_publisher"/>

	<node pkg="laser_scan_matcher" type="laser_scan_matcher_node" name="laser_scan_matcher_node" output="screen">
		<param name = "max_iterations" 			value="10"/>
		<param name = "laser_scan_matcher_node/publish_pose_with_covariance" value="true"/>
		<param name = "publish_tf"				value = "false"/>
		<param name = "publish_pose_stamped"	value = "false"/>
		<param name = "use_odom"				value = "false"/>
		<param name = "fixed_frame"				value = "odom"/>
		<param name = "base_frame"				value = "base_link"/>
 	</node>

	<node pkg = "tf" type = "tf_remap" name = "tf_remapper" output = "screen">
		<rosparam param = "mappings"> - {old: "/laser_frame", new: "/laser"} </rosparam>
  	</node>

	<arg name="ticks_per_meter" value="5593" />
    <arg name="wheel_separation" value="0.275" />
    <node name="controller" pkg="diff_drive" type="diff_drive_controller" output="screen">
        <rosparam subst_value="true">
            ticks_per_meter: $(arg ticks_per_meter)
            wheel_separation: $(arg wheel_separation)
            max_motor_speed: 50
            timeout: 1.0
        </rosparam>
    </node>
</launch>
